# Include the common built-in commands
from: commands

# Docker configurations
docker:
    # Initialization commands running on host for only docker enabled
    initialization_commands:
        - which docker > /dev/null 2>&1 || (curl -fsSL https://get.docker.com -o /tmp/get-docker.sh && sed -i "s/set -x/set +x/g" /tmp/get-docker.sh &&
          ((export VERSION=20.10 && sudo --preserve-env=VERSION bash /tmp/get-docker.sh > /dev/null) || sudo bash /tmp/get-docker.sh > /dev/null) && sudo usermod -aG docker $USER && sudo systemctl restart docker -f)
        - docker ps -a &> /dev/null || (sudo addgroup --system docker && sudo usermod -aG docker $USER && sudo systemctl restart docker -f)
        - which jq > /dev/null 2>&1 || (sudo apt-get -qq update -y && sudo apt-get -qq install -y jq > /dev/null)
    head_initialization_commands: []
    worker_initialization_commands: []
